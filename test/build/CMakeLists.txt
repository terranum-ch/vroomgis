# CMAKE BUILD FILE FOR TESTING VROOMGIS
# USE WXWIDGETS (CONSOLE)
# PART OF QA FOR VROOMGIS 
# (c) LUCIEN SCHREIBER CREALP 2009
cmake_minimum_required(VERSION 2.4)


## POLICY FOR WINDOWS ONLY ???
if(COMMAND cmake_policy)
    cmake_policy(SET CMP0003 NEW)
endif(COMMAND cmake_policy)

# REMOVE THIS LINE IF CALLED FROM ANOTHER CMAKE FILE
SET (PROGNAME "vroomgis")
SET (PROGNAMETEST ${PROGNAME}_test)
PROJECT(${PROGNAMETEST})


#search all source files
FILE (GLOB SRC_FILES ../src/*.cpp)
SOURCE_GROUP(source FILES ${SRC_FILES})

# search all headers files
FILE (GLOB HEAD_FILES "../src/*.h")
SOURCE_GROUP(header FILES ${HEAD_FILES})

MESSAGE ("Build type is : " ${CMAKE_BUILD_TYPE})

#ONLY USED FOR ADDING HEADERS TO PROJECT 
IF(APPLE)
	ADD_EXECUTABLE(not_build EXCLUDE_FROM_ALL main.cpp ${HEAD_FILES})
ENDIF(APPLE)


# WXWIDGETS
# DEFINE ALL INCLUDES AND SO ON
 SET(WXWINDOWS_USE_GL 0) 
 INCLUDE ("cmake/Use_wxWindows.cmake")

## CXXTEST LIBRARY STUFF
# Use Python interpreter
FIND_PACKAGE(PythonInterp)
# Fait la liaison avec la biblioth√®que CxxTest  
INCLUDE("cmake/FindCxxTest.cmake")
SET(CXXTEST_USE_PYTHON 1)
INCLUDE_DIRECTORIES(${CXXTEST_INCLUDE_DIR})
ENABLE_TESTING()

CXXTEST_ADD_TEST(${PROGNAMETEST} main.cpp ${HEAD_FILES})


#CREATE LIB WITH ALL MAIN PROJECT CLASS
#search all source files
FILE (GLOB LIB_SRC_FILES ../../src/*.cpp)
SOURCE_GROUP(source FILES ${LIB_SRC_FILES})

# search all headers files
FILE (GLOB LIB_HEAD_FILES "../../src/*.h")
SOURCE_GROUP(header FILES ${LIB_HEAD_FILES})
INCLUDE_DIRECTORIES("../../src")

ADD_LIBRARY(vroomgistestlib STATIC ${LIB_SRC_FILES})
TARGET_LINK_LIBRARIES(${PROGNAMETEST} vroomgistestlib)

 
# ADD ALSO HEADERS NOT REALY NEEDED JUST FOR VS
# COMPILING

#IF (WIN32)
 #	ADD_EXECUTABLE (${PROGNAMETEST} WIN32 ${SRC_FILES} ${HEAD_FILES})
 #	TARGET_LINK_LIBRARIES (${PROGNAMETEST})

#ELSE (WIN32)
 #	ADD_EXECUTABLE (${PROGNAMETEST} ${SRC_FILES} ${HEAD_FILES} ) 
 
#ENDIF (WIN32)


# SHOULD WE USE THE MT VERSION FOR DEFAULT 
# COMPATIBILITY WITH < WINXP
#IF (WIN32)
#	INCLUDE ("cmake/Use_visualstudioMT.cmake")
#ENDIF (WIN32)

